# GBP Manager

Google スプレッドシート用の Google Apps Script スクリプト集です。
主にスプレッドシート内のデータ整形やコメント抽出を自動化します。

## 構成ファイル

- `extractComments.js`
  - スプレッドシート内の全シートを対象に、Google翻訳コメントから元の言語のテキスト（原文）を抽出します。
  - 除外したいシート名や、コメント列、開始行などはスクリプト冒頭で設定できます。
  - (Original) マーカーがあればその後ろ、なければ (Translated by Google) の前のテキストを抽出します。
  - 抽出結果は元のセルに上書きされます。

- `formatDate.js`
  - 全シートのA列の日付をUTCからJST（日本標準時）に変換し、`yyyy/MM/dd` 形式で表示します。
  - スプレッドシートのタイムゾーン設定が「(GMT+09:00) 東京」である必要があります。
  - 日付以外の値や空セルはそのまま残ります。

- `appsscript.json`
  - Google Apps Script プロジェクトの設定ファイルです。
  - タイムゾーンは `Asia/Tokyo` に設定されています。
  - 例外ログは Stackdriver で記録されます。
  - ランタイムは V8 です。

## 使い方

1. Google スプレッドシートを開き、拡張機能 > Apps Script から本リポジトリのスクリプトを貼り付けてください。
2. 必要に応じて、`extractComments.js` の設定値（コメント列番号、開始行、除外シート名など）を編集してください。
3. スクリプトエディタから `extractComments` または `formatDate` 関数を実行してください。

## 注意事項

- スクリプト実行前に、必ずスプレッドシートのバックアップを取ってください。
- スクリプトは元データを上書きします。
- スプレッドシートのタイムゾーン設定が正しいことを確認してください。 