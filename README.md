# GBP Manager

Google スプレッドシート用の Google Apps Script スクリプト集です。  
口コミデータの抽出・整形・レポート出力を自動化し、業務効率化をサポートします。

---

## 機能一覧

### 1. 口コミ原文抽出（extractComments.js）
- 全シートの指定列からGoogle翻訳コメントの「原文」部分のみを抽出し、セルを上書きします。
- 除外シートや対象列・開始行はスクリプト冒頭で設定可能。
- (Original) や (Translated by Google) マーカーに対応。

### 2. 日付フォーマット変換（formatDate.js）
- 全シートA列の日付をUTCからJST（日本標準時）に変換し、`yyyy/MM/dd` 形式で表示します。
- スプレッドシートのタイムゾーンが「(GMT+09:00) 東京」である必要があります。
- 日付以外の値や空セルはそのまま残ります。

### 3. 口コミレポート自動生成（docGenerator.js）
- 指定した年・月の口コミデータのみを抽出し、全店舗分をまとめたGoogleドキュメントを自動生成します。
- 出力先フォルダや対象年月はダイアログで簡単に設定可能。
- 店舗ごとに見出し・日付・星評価・投稿者・内容を整形して出力。
- 成功・情報通知はトーストで表示、エラー時のみダイアログで通知。

### 4. メニュー拡張（main.js）
- スプレッドシートのメニューに「ドキュメント出力」メニューを追加。
- 口コミレポート出力や設定ダイアログをワンクリックで実行可能。

---

## 使い方

1. Google スプレッドシートを開き、拡張機能 > Apps Script から本リポジトリのスクリプトを貼り付けてください。
2. 必要に応じて各スクリプトの設定値（列番号、開始行、除外シート名など）を編集してください。
3. スプレッドシート上部メニュー「ドキュメント出力」から各機能を実行できます。

---

## 注意事項

- スクリプト実行前に、必ずスプレッドシートのバックアップを取ってください。
- スクリプトは元データを上書きします。
- スプレッドシートのタイムゾーン設定が正しいことを確認してください（特に日付変換機能を利用する場合）。

---

## ファイル構成

- `extractComments.js` … 口コミ原文抽出
- `formatDate.js` … 日付フォーマット変換
- `docGenerator.js` … 口コミレポート自動生成
- `main.js` … メニュー拡張
- `appsscript.json` … GASプロジェクト設定 